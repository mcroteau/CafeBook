<!DOCTYPE html>
<html>
<head>
	
	<title>A Simple J2ee Project : Cafe</title>

	<meta name="description" content="">

	<meta name=”viewport” content=”width=device-width, initial-scale=1″>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	
<!--	<link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&display=swap" rel="stylesheet">-->

	<link href="images/" rel="icon" type="image/png" />

	<script async defer src="https://buttons.github.io/buttons.js"></script>

	<link rel="stylesheet" href="css/bootstrap.css">

	<style type="text/css">
		html,body,
		div, span, p, blockquote,
		h1, h2, h3, h4{
			color:#333333;
			color:#19191B;
			font-family:'Roboto';
            font-family: 'Arial'
		}
		h1{
			font-weight:900;
			font-size:102px !important;
			text-align: left;
		}
		h2{
			font-size:73px;
			text-align: left;
			margin-top:70px;
			font-weight:900;
			line-height: 1.7em;
		}
		h3{
			font-size:39px;
			font-weight:900;
			text-align: left;
			margin:40px auto 10px;
		}
		#logo{
			margin-top:72px;
		}
		#title{
			font-size:27px;
			display:block;
			text-align: center;
			padding:0px !important;
			margin:30px 0px 3px 0px !important;
		}
		#cover{
			width:64% !important;
			margin-left:20px !important;
			float:left
		}
		#subtitle{
			font-size:21px;
			display:block;
			text-align: center;
			margin:0px 0px 27px 0px;
		}
		#subtitle-dos{
			font-size:39px;
			display:block;
			text-align: center;
			margin:0px 0px 27px 0px;
		}
		h1#and-if{
			font-size:172px !important;
			line-height:1.4em !important;
		}
		#content{
			/**width:652px;**/
			margin:0px auto 400px auto !important;
			font-family:arial;
			font-size:27px !important;
			line-height:1.82em !important;
			text-align:left;
		}
		#like-share{
			text-align: center;
			margin:0px !important;
		}
		#challenge{
			margin-top:172px;
			display:block;
		}
		#africa-container{
			padding:0px;
			height:352px;
			margin:30px auto 89px auto !important;
		}
		#africa{
			margin:0px 0px 0px 0px;
		}
		.fb-like{
			margin-bottom:12px;
		}
		p{
			text-align: left;
			margin:20px 0px !important;
		}
		.emphasis{
			font-size:1.7em;
			line-height:2.3em;
		}
		.space-it{
			margin-top:102px !important;
		}
		.big{
			font-size:2.3em;
		}

		.minor{
			font-size:.52em;
		}

		.bold{
			font-weight:bold;
		}

		img{
			margin:auto;
		}
		img.left{
			margin:0px !important;
		}
		blockquote{
			color:#777;
			margin-top:300px;
		}
		.github-button{
			margin-bottom:30px;
			position:relative;
			display:inline-block;
			padding-bottom:30px;
		}
		.large{
			font-size:67px;
		}
		.italic{
			font-style:italic;
		}
		.center{
			text-align: center;
		}

		#buy-the-book{
			display:block;
			z-index:10001;
			position: fixed;
  			transform: rotate(45deg); /* Equal to rotateZ(45deg) */
			top:60px;
			right:-400px;
			height:40px;
			width:1000px;
			color:#fff;
			font-size:23px;
			padding-top:3px;
			font-family: Georgia;
			text-align: center;
			background:#323232;
			-webkit-box-shadow: 0px 0px 26px 0px rgba(163,160,163,1);
			-moz-box-shadow: 0px 0px 26px 0px rgba(163,160,163,1);
			box-shadow: 0px 0px 26px 0px rgba(163,160,163,1);
			-webkit-animation-name: logo-logo; /* Safari 4.0 - 8.0 */
		    -webkit-animation-duration: 4s; /* Safari 4.0 - 8.0 */
		    animation-name: logo-logo;
		    animation-iteration-count: infinite;
		    animation-duration: 73s;
			text-decoration: none;    
		}

		/* Safari 4.0 - 8.0 */
		@-webkit-keyframes logo-logo {
		  0%  {background: #323232;}
		  43%  {background: #E34B86;}
		  81% {background: #12ADFD;}
		  100% {background: #323232;}
		}

		@keyframes logo-logo {
		  0%  {background: #323232;}
		  43%  {background: #E34B86;}
		  81% {background: #12ADFD;}
		  100% {background: #323232;}
		}

		span em{
			font-family:Georgia;
			font-style:normal;
		}

		#player{
			margin-top:10px;
		}
	</style>
</head>

<body>

	<!--<a href="https://www.amazon.com/dp/0359620736" id="buy-the-book"><img src="images/buy-the-book.png"/></a>-->

	<a href="https://www.amazon.com/dp/0359620736" id="buy-the-book">Buy the Book!</a>

	<div id="content" class="container">

		<div class="col-md-2">&nbsp;</div>


		<div class="col-md-7">

			<h1 id="title">Cafe</h1>

			<h2 id="subtitle">A Simple J2ee Project</h2>
			<h3 id="subtitle-dos">Java Web Application Sample</h3>

			<p>This will walk you through step by step and we will create
				a simple blog application running locally on your development
				machine running <strong> h2</strong> and <strong>Jetty</strong>.
				We will not dive too far into details, rather give you a 10,000
				foot view of <strong>J2ee</strong> architecture.</p>
			
			<h3>What is J2ee</h3>

			<p><strong>J2ee</strong> is short for <strong>Java Web Application
				Development</strong>. It is enterprise ready! It is modular,
				secular and beautiful! We hope you enjoy it as much as we do.
				Without further adoo, let's go further... and build our Cafe</p>

			<p>We hope you are either running Linux, Windows with GitBash or Mac.</p>

			<img src="images/cafe.jpg" style="width:100%" class="left"/>

			<h2>First things first...</h2>

			<p>We need to install <strong>OpenJdk</strong> which will be our
				Java binary distribution and <strong>Maven</strong> our build tool.
				Installing simply means downloading the binaries and adding them to
				your system path. Here is how it is done.</p>

			<p>Browse to <a href="https://adoptopenjdk.net" target="_blank">https://adoptopenjdk.net</a>
				 and select a OpenJdk to download. Download &amp; unpack... </p>

			<p>Next we need to download Maven. Maven is our build tool, it will find &amp;
				download project dependencies for us and compile the project when
				deploying or running locally. Download then open up your <strong>.bashrc</strong>
				it is located in the home directory, if it's not there you will need to create
				it. <strong>~/</strong> means root or home directory.
				Open up a command prompt and type on a mac:</p>

			<pre>open ~/.bashrc</pre>

			<p>Our final <strong>.bashrc</strong> should look something like:</p>

			<pre>
#!/bin/bash

export JAVA_HOME=/Library/Java/JavaVirtualMachines/adoptopenjdk-8-openj9.jdk/Contents/Home
export PATH=$PATH:$JAVA_HOME/bin

export MAVEN_HOME=/Users/mcroteau/Development/Tools/apache-maven-3.6.3
export PATH=$PATH:$MAVEN_HOME/bin</pre>

			<p>Now lets "Source" which means execute our <strong>.bashrc</strong>
			so that java commands and maven commands are available! In the same
				command prompt type:</p>

			<pre>source ~/.bashrc</pre>

			<p>We will be working within the same command prompt for most of the time.
			We will need to open up another terminal/command prompt in the future
				in addition to this one.</p>

			<p>We should now be able to type <strong>java</strong>
				and <strong>mvn</strong> commands!</p>

			<pre>java -version</pre>

			<p>Should output something like the following</p>

			<pre>openjdk version "1.8.0_265"
OpenJDK Runtime Environment (build 1.8.0_265-b01)
Eclipse OpenJ9 VM (build openj9-0.21.0, JRE 1.8.0 Mac OS X amd64-64-Bit Compressed References 20200728_646 (JIT enabled, AOT enabled)
OpenJ9   - 34cf4c075
OMR      - 113e54219
JCL      - c82ff0c20f based on jdk8u265-b01)</pre>

			<p>Do the same for Maven, type:</p>

			<pre>mvn --version</pre>

			<p>It should output something like:</p>

			<pre>
Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)
Maven home: /Users/mcroteau/Development/Tools/maven-current
Java version: 1.8.0_265, vendor: Eclipse OpenJ9, runtime: /Library/Java/JavaVirtualMachines/adoptopenjdk-8-openj9.jdk/Contents/Home/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "mac os x", version: "10.11.6", arch: "x86_64", family: "mac"
			</pre>

			<p><strong>Congratulations!</strong> You are on your way... let's get started.</p>


			<h3>Project Structure</h3>

			<p>We need to create our project. Create all of the following
			directories so that it looks like:</p>

<pre>
Cafe/
Cafe/src/main/java/xyz/cafe/access
Cafe/src/main/java/xyz/cafe/common
Cafe/src/main/java/xyz/cafe/dao
Cafe/src/main/java/xyz/cafe/model
Cafe/src/main/java/xyz/cafe/startup
Cafe/src/main/java/xyz/cafe/web/post
Cafe/src/main/webapp/jsp/post
Cafe/src/main/WEB-INF</pre>


			<p>The directories or folders above are for
				supporting <strong>Servlets</strong>,
				<strong>Data Access Objects</strong>
				and <strong>Models</strong>.</p>

			<p>Please make sure all folders/directories are created.</p>

			<p>If you are developer then you are probably familiar with this
			project setup. If not, this is the cleanest most awesome way to configure
			your project. The pattern is called MVC which stands for Model View Controller.
			We have the <strong>web</strong> folder for controllers/servlets,
				the <strong>model</strong> folder for our models, and our
				<strong>jsp</strong> folder for our views.</p>


            <h3>Do you have an IDE already?</h3>

            <p><strong>What is an IDE?</strong> An IDE is an Integrated
                Development Environment, basically a tool to use in order to develop.
                Often times developers will use plain text editors, this will work fine
                but you will not have package or directory management, code assist and a lot
                fun features that a full fledged IDE has. We recommend either Eclipse or
                during this tutorial, I am using IntelliJ.
                <a href="https://www.jetbrains.com/idea/download/">https://www.jetbrains.com/idea/</a>
                They have a community addition, which is Free.
            </p>

            <a href="https://www.jetbrains.com/idea/download/"><img src="images/intellij-web.png" style="width:100%"/>
            </a>

            <p>Hold off before importing the project until you've
                created what is called <strong>pom.xml</strong>. The reason we
            are holding off until importing into our new IDE is because the IDE
            will configure the project within using the <strong>pom.xml</strong></p>

			<p>Use a simple text editor for this and
                create a file within the <strong>root Cafe</strong> directory,
                name it <strong>pom.xml</strong>. The <strong>pom.xml</strong> will
			be our main project configuration file. We will list our project
			dependencies within it. We will also configure a build &amp; run plugin
			to test our project.</p>

			<p>We are going to start from scratch so paste the following into that
				new pom.xml file:</p>
<pre>
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;xyz.cafe&lt;/groupId&gt;
    &lt;artifactId&gt;cafe&lt;/artifactId&gt;
    &lt;version&gt;0.1&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

    &lt;dependencies&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;jstl&lt;/groupId&gt;
            &lt;artifactId&gt;jstl&lt;/artifactId&gt;
            &lt;version&gt;1.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
            &lt;version&gt;4.0.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;version&gt;1.4.200&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;opensymphony&lt;/groupId&gt;
            &lt;artifactId&gt;sitemesh&lt;/artifactId&gt;
            &lt;version&gt;2.4.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;io.github.mcroteau&lt;/groupId&gt;
            &lt;artifactId&gt;parakeet&lt;/artifactId&gt;
            &lt;version&gt;0.2&lt;/version&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;

    &lt;build&gt;

        &lt;defaultGoal&gt;package&lt;/defaultGoal&gt;

        &lt;directory&gt;output&lt;/directory&gt;
        &lt;outputDirectory&gt;output/classes&lt;/outputDirectory&gt;

        &lt;finalName&gt;${project.artifactId}-${project.version}&lt;/finalName&gt;
        &lt;sourceDirectory&gt;src/main/java&lt;/sourceDirectory&gt;

        &lt;plugins&gt;

            &lt;plugin&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.5.1&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.8&lt;/source&gt;
                    &lt;target&gt;1.8&lt;/target&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;

            &lt;plugin&gt;
                &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;jetty-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;9.4.20.v20190813&lt;/version&gt;

                &lt;configuration&gt;
                    &lt;webApp&gt;
                        &lt;contextPath&gt;/cafe&lt;/contextPath&gt;
                    &lt;/webApp&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;

        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</pre>

			<p>What we've done above is configured and told Maven
				to look for all the dependencies within the <strong>&lt;dependencies/&gt;</strong>
				element, where to look for our Java source files, what version of Java
				to compile under and configured the project to use <strong>Jetty</strong>
				to run it in development mode.</p>

            <p>Now lets import the project into our IDE. In this example we will use
            IntelliJ. Open IntelliJ and click <strong>Open or Import</strong>. Locate
            the <strong>pom.xml</strong> and double click the file. This will bring up
            prompt asking whether or not you want to <strong>Open as Project</strong>. Click
            <strong>Open as Project</strong>. IntelliJ will import the project for you. </p>

            <img src="images/intellij-import.png" style="width:100%;"/>

			<p>Now let's configure the project as a Web project by adding a
			<strong>web.xml</strong>. Copy and paste the following:</p>
			<pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee
                             http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; version=&quot;3.1&quot;&gt;

    &lt;listener&gt;
        &lt;listener-class&gt;
            xyz.cafe.startup.AppStartup
        &lt;/listener-class&gt;
    &lt;/listener&gt;

&lt;/web-app&gt;
			</pre>

            <p>Copy and paste above into the file:</p>

            <pre>src/main/webapp/WEB-INF/<strong>web.xml</strong></pre></p>


            <p>Okay, so what have we done here? We have configured our
            project to look for what are called servlets, filters, listeners and
                more. This <strong>web.xml</strong> is empty but we will
                populate it with lots of stuff later on.</p>

            <p><strong>What is a Servlet?</strong> A servlet is a Java class that
                represents a web route.
            A request gets passed to this route that is defined as you saw above. Here is
            an example.. there are plenty above but let's pick one out and go into detail.</p>

            <p>The standard for defining a Servlet</p>
            <pre>
&lt;servlet&gt;
    &lt;servlet-name&gt;CreateServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;xyz.cafe.web.post.CreateServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;CreateServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/create&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
            </pre>

            <p>So we defined here in our project a Servlet that we named
            <strong>CreateServlet</strong> it will be located in the folder
            <pre>src/main/java/xyz/cafe/web/post</pre> The request will get
                passed to <strong>/create</strong> like below:</p>

            <pre>http://localhost:8080/cafe/<strong>create</strong></pre>

            <p><strong>What is a request?</strong> A request is a web request.
            Anytime you type in a browser bar and hit enter, that is called
            a <strong>Request</strong>.</p>

            <p>We defined for the blog post the following:</p>

            <ul>
                <li><strong>ListServlet</strong> : which will list the blog posts</li>
                <li><strong>CreateServlet</strong> : displays a create blog post</li>
                <li><strong>SaveServlet</strong> : saves a post</li>
                <li><strong>UpdateServlet</strong> : allows us to update a post</li>
                <li><strong>EditServlet</strong> : allowing us to edit our post</li>
                <li><strong>DeleteServlet</strong> : to delete a post</li>
            </ul>

            <h3>Great! But...</h3>

            <p>We have no Servlets created and we haven't even
                run our project yet! Okay, let's create one and also while
                we are at it create the Java class that will be waiting for the
                project to start up. </p>

            <p>Take another look at the <strong>web.xml</strong>. Track down
            the following.</p>

            <pre>
&lt;listener&gt;
    &lt;listener-class&gt;
        xyz.cafe.startup.AppStartup
    &lt;/listener-class&gt;
&lt;/listener&gt;
            </pre>

            <p>Within your <strong>web.xml</strong> you can define what are called
            application listeners. In this case we are defining a class that will
            listen for the startup event... thus the name AppStartup. So let's
            create that class.</p>

            <pre>src/main/java/xyz/cafe/startup/<strong>AppStartup.java</strong></pre>

            <p>Copy and paste the following into that file. We will be updating it
            with more logic later on, but this will get us started.</p>

            <pre>
package xyz.cafe.startup;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

public class AppStartup implements ServletContextListener {

    @Override
    public void contextInitialized(ServletContextEvent sce) {
        //application startup
    }

    @Override
    public void contextDestroyed(ServletContextEvent sce) {
        //application shutdown
    }

}
            </pre>

            <p>Now let's try something... let's run our project and see what happens.
            Just in case, this is what your project should look like at this point: </p>

            <img src="images/project-start.png" style="width:100%"/>

            <p>Let's start with
                the CreateServlet so we can run our newly created project and
                actually see something... geez.</p>

            <p>Back to your IDE, in the directory</p>
                <pre>src/main/java/xyz/cafe/post/</pre>

            <p>create a Java
                class by right clicking on the <strong>post</strong> directory
            and selecting <strong>New -> Java Class</strong>. Or just create a new
            file and name it <strong>CreateServlet.java</strong></p>

            <pre>/src/main/java/xyz/cafe/post/<strong>CreateServlet.java</strong></pre>

            <p>Copy and the code below into your new Java class.</p>

            <pre>
package xyz.cafe.web.post;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

public class CreateServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        req.getRequestDispatcher("/jsp/post/create.jsp").forward(req, resp);
    }
}
            </pre>


            <p>Notice the CreateServlet extends HttpServlet... this means that all the methods
            that are within <strong>HttpServlet</strong> are overrideable. There are three
            very important methods that you will at some point in time override if writing
            a J2ee application. <strong>doGet()</strong> <strong>doPost()</strong>
            and <strong>init()</strong></p>

            <p>Here we override <strong>doGet()</strong></p>

            <p>There is another important piece, notice the forward at the end,
                without the <strong>.forward(req, resp)</strong> you will see a
            blank screen.</p>
            <pre>
req.getRequestDispatcher("/jsp/post/create.jsp").forward(req, resp);
            </pre>

            <p>So we have out first servlet, and it overrides a
            <strong>doGet()</strong> verb which means nothing is hidden,
            you can simply type in the servlet path, hit enter and browse to the
            servlet. We don't have a <strong>create.jsp</strong> yet.
            Let's create that. Create the <strong>create.jsp</strong> at:</p>

            <pre>src/main/webapp/jsp/post/<strong>create.jsp</strong></pre>

            <p>Copy and past the following code within the <strong>create.jsp</strong>.</p>


            <pre>
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;

&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Cafe : Create Post&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Create Post&lt;/h1&gt;

&lt;c:if test=&quot;${not empty message}&quot;&gt;
    &lt;p&gt;&lt;c:out value=&quot;${message}&quot;/&gt;&lt;/p&gt;
&lt;/c:if&gt;

&lt;form action=&quot;${pageContext.request.contextPath}/save&quot; method=&quot;post&quot;&gt;

    &lt;label&gt;Title&lt;/label&gt;
    &lt;input type=&quot;text&quot; name=&quot;title&quot; placeholder=&quot;title&quot;/&gt;

    &lt;br/&gt;

    &lt;label&gt;Content&lt;/label&gt;
    &lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;

    &lt;br/&gt;
    &lt;br/&gt;

    &lt;input type=&quot;submit&quot; value=&quot;Save&quot;/&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;
            </pre>


            <strong>What is a Jsp?</strong> Jsp stands for Java Server Page.
            It is the view in our Model, View, Controller setup.</p>

            <p>Okay! We now have the basics for a Java web app. Let's run it!</p>

            <p>Back to the terminal or command prompt. Make sure you're in the main
            <strong>Cafe</strong> directory. Type:</p>

            <pre>mvn jetty:run</pre>

            <p>You will see a bunch of output, this is logging. We won't go into that
            but if you want to learn more about logging checkout <strong>slf4j</strong></p>

            <p>So what did we do? We told Maven to compile the project and told
            <strong>Jetty</strong> to run it. Now open up a web browser and go to:</p>

            <pre>http://localhost:8080/cafe</pre>

            <p>You should see the following.</p>

            <img src="images/app-base.png" style="width:100%"/>

            <p>This is our start. We might not like this as our start obviously because
            this shows the basic standard packages but its not really what we are looking for
            with our blog application. We will change this soon. Go ahead now and lets
            browse to our first servlet, the <strong>CreateServlet</strong> at
            <strong>/create</strong></p>

            <pre>http://localhost:8080/cafe/create</pre>

            <p class="center space-it">&copy; OpenCafe</p>


		</div>

		<div class="col-md-3">&nbsp;</div>

		</div>
	</body>
</html>













































